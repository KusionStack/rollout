
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.5.0
  creationTimestamp: null
  name: tasks.rollout.kusionstack.io
spec:
  group: rollout.kusionstack.io
  names:
    kind: Task
    listKind: TaskList
    plural: tasks
    singular: task
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Task is the Schema for the tasks API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: TaskSpec defines the desired state of Task
            properties:
              custom:
                description: Custom is used to run custom task defined by the user
                properties:
                  executor:
                    description: Executor is the executor that will execute the custom task
                    properties:
                      endpoint:
                        description: Endpoint is the endpoint of the executor server
                        type: string
                    required:
                    - endpoint
                    type: object
                  name:
                    description: Name is the name of the custom task
                    type: string
                required:
                - executor
                - name
                type: object
              echo:
                description: Echo is used to print out the message, mainly for testing or demo purpose
                properties:
                  message:
                    description: Message is the message to echo
                    type: string
                required:
                - message
                type: object
              params:
                description: Params is a list of input parameters required to run the task.
                items:
                  description: Param defines the parameter of a task
                  properties:
                    name:
                      description: Name is the name of the parameter
                      type: string
                    value:
                      description: Value is the value of the parameter
                      properties:
                        arrayValue:
                          description: ArrayValue is the array value of the parameter
                          items:
                            type: string
                          type: array
                          x-kubernetes-list-type: atomic
                        boolValue:
                          description: BoolValue is the bool value of the parameter
                          type: boolean
                        intValue:
                          description: IntValue is the int value of the parameter
                          type: integer
                        objectValue:
                          additionalProperties:
                            type: string
                          description: ObjectValue is the object value of the parameter
                          type: object
                        stringValue:
                          description: StringValue is the string value of the parameter
                          type: string
                        type:
                          type: string
                      required:
                      - arrayValue
                      - boolValue
                      - intValue
                      - objectValue
                      - stringValue
                      - type
                      type: string
                      x-kubernetes-preserve-unknown-fields: true
                  required:
                  - name
                  - value
                  type: object
                type: array
              resource:
                description: Resource type task is used to manipulate k8s resources
                properties:
                  action:
                    description: Action is the action to be performed on the resource
                    type: string
                  checker:
                    description: Checker is the checker to check if the task is successful
                    properties:
                      builtInChecker:
                        description: BuiltInChecker is the built-in checker to check if the task is successful
                        properties:
                          params:
                            description: Params is the parameters of the built-in checker
                            items:
                              description: Param defines the parameter of a task
                              properties:
                                name:
                                  description: Name is the name of the parameter
                                  type: string
                                value:
                                  description: Value is the value of the parameter
                                  properties:
                                    arrayValue:
                                      description: ArrayValue is the array value of the parameter
                                      items:
                                        type: string
                                      type: array
                                      x-kubernetes-list-type: atomic
                                    boolValue:
                                      description: BoolValue is the bool value of the parameter
                                      type: boolean
                                    intValue:
                                      description: IntValue is the int value of the parameter
                                      type: integer
                                    objectValue:
                                      additionalProperties:
                                        type: string
                                      description: ObjectValue is the object value of the parameter
                                      type: object
                                    stringValue:
                                      description: StringValue is the string value of the parameter
                                      type: string
                                    type:
                                      type: string
                                  required:
                                  - arrayValue
                                  - boolValue
                                  - intValue
                                  - objectValue
                                  - stringValue
                                  - type
                                  type: string
                                  x-kubernetes-preserve-unknown-fields: true
                              required:
                              - name
                              - value
                              type: object
                            type: array
                          type:
                            description: Type is the type of the built-in checker
                            type: string
                        required:
                        - type
                        type: object
                      failureCondition:
                        description: FailureCondition is the condition to check if the task is failed
                        type: string
                      successCondition:
                        description: SuccessCondition is the condition to check if the task is successful
                        type: string
                    type: object
                  manifest:
                    description: Manifest is the manifest of the resource
                    type: string
                  manifestFrom:
                    description: ManifestFrom is the source of the manifest
                    properties:
                      git:
                        description: Git defines the git artifact details
                        type: object
                      http:
                        description: HTTP defines the http artifact details
                        properties:
                          body:
                            description: Body is the body of the http request
                            type: string
                          headers:
                            additionalProperties:
                              type: string
                            description: Headers are the headers of the http request
                            type: object
                          method:
                            description: Method is the method of the http request
                            type: string
                          url:
                            description: URL is the url of the artifact
                            type: string
                        required:
                        - url
                        type: object
                      name:
                        description: Name is the name of the artifact
                        type: string
                    type: object
                  mergeStrategy:
                    description: MergeStrategy is the strategy to merge a patch. Defaults to "strategic".
                    type: string
                required:
                - action
                type: object
              retryStrategy:
                description: RetryStrategy defines the retry strategy for the task when it fails
                properties:
                  backoff:
                    description: Backoff is the backoff strategy
                    type: object
                  limit:
                    description: Limit is the maximum number of retries
                    type: integer
                required:
                - limit
                type: object
              status:
                description: Status is used to control the status of the task
                type: string
              suspend:
                description: Suspend is used to pause the task
                properties:
                  approved:
                    description: Approved indicates whether the task is approved to continue
                    type: boolean
                  duration:
                    description: Duration is the duration to suspend the workflow
                    format: int64
                    type: integer
                type: object
              webhook:
                description: Webhook is used to run webhook
                properties:
                  action:
                    description: Action is the operation that would be executed.
                    type: string
                  allBatchParams:
                    additionalProperties:
                      additionalProperties:
                        type: string
                      type: object
                    description: AllBatchParams contains all batches parameters from rollout strategy.
                    type: object
                  hookType:
                    description: HookType is the type of the check point
                    type: string
                  name:
                    description: Name indicates the provider name.
                    type: string
                required:
                - action
                - allBatchParams
                - hookType
                - name
                type: object
              workloadRelease:
                description: WorkloadRelease is used to release the workload
                properties:
                  partition:
                    anyOf:
                    - type: integer
                    - type: string
                    description: Partition is the partition of the workload release
                    x-kubernetes-int-or-string: true
                  readyCondition:
                    description: ReadyCondition is the condition to check if the task is successful
                    properties:
                      atLeastWaitingSeconds:
                        description: AtLeastWaitingSeconds is the seconds to wait at least
                        format: int32
                        type: integer
                      failureThreshold:
                        anyOf:
                        - type: integer
                        - type: string
                        description: FailureThreshold indicates how many failed pods can be tolerated before marking the task as success in the workload scope
                        x-kubernetes-int-or-string: true
                      taskFailureThreshold:
                        anyOf:
                        - type: integer
                        - type: string
                        description: TaskFailureThreshold indicates how many failed pods can be tolerated before marking the task as success in the task scope
                        x-kubernetes-int-or-string: true
                    type: object
                  workload:
                    description: Workload is the workload of the task
                    properties:
                      apiVersion:
                        description: APIVersion is the group/version for the resource being referenced. If APIVersion is not specified, the specified Kind must be in the core API group. For any other third-party types, APIVersion is required.
                        type: string
                      cluster:
                        description: Cluster is the cluster of the task
                        type: string
                      kind:
                        description: Kind is the type of resource being referenced
                        type: string
                      name:
                        description: Name is the name of the workload
                        type: string
                      namespace:
                        description: Namespace is the namespace of the workload
                        type: string
                    required:
                    - kind
                    type: object
                required:
                - workload
                type: object
            type: object
          status:
            description: TaskStatus defines the observed state of Task
            properties:
              conditions:
                description: Conditions is a list of conditions of the task
                items:
                  description: 'Condition defines the condition of a resource See: https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#typical-status-properties'
                  properties:
                    lastTransitionTime:
                      description: Last time the condition transitioned from one status to another.
                      format: date-time
                      type: string
                    lastUpdateTime:
                      description: The last time this condition was updated.
                      format: date-time
                      type: string
                    message:
                      description: A human-readable message indicating details about the transition.
                      type: string
                    reason:
                      description: The reason for the condition's last transition.
                      type: string
                    status:
                      description: Status of the condition, one of True, False, Unknown.
                      type: string
                    type:
                      description: Type of the condition.
                      type: string
                  required:
                  - status
                  - type
                  type: object
                type: array
              finishedAt:
                description: FinishedAt is the time when the task finished
                format: date-time
                type: string
              lastUpdatedAt:
                description: LastUpdatedAt is the time when the task status was last updated
                format: date-time
                type: string
              message:
                description: Message is the message of the task
                type: string
              observedGeneration:
                description: ObservedGeneration is the most recent generation observed for this Task. It corresponds to the Task's generation, which is updated on mutation by the API Server.
                format: int64
                type: integer
              phase:
                description: Phase is the current phase of the task
                type: string
              startedAt:
                description: StartedAt is the time when the task started
                format: date-time
                type: string
              webhook:
                description: Webhook is the status of webhook task.
                properties:
                  endTimestamp:
                    description: EndTimestamp is the time when the task is finished
                    format: date-time
                    type: string
                  hookType:
                    description: HookType indicates the type of webhook
                    type: string
                  passed:
                    description: Passed indicates whether the webhook check has passed or not.
                    type: boolean
                  provider:
                    description: Provider indicates the provider name.
                    type: string
                  startTimestamp:
                    description: StartTimestamp is the time when the task is started
                    format: date-time
                    type: string
                  status:
                    description: Status is the webhook check task status.
                    type: string
                  verdict:
                    description: Verdict is the decision of webhook check if it is not passed.
                    type: string
                required:
                - hookType
                - passed
                - provider
                - status
                - verdict
                type: object
              workloadRelease:
                description: WorkloadRelease is the status of the workload release task
                properties:
                  name:
                    description: Name is the name of the workload
                    type: string
                  observedGenerationUpdated:
                    description: ObservedGenerationUpdated indicates if the observedGeneration is updated to the latest generation
                    type: boolean
                  replicas:
                    description: Replicas is the number of replicas
                    format: int32
                    type: integer
                  updatedAvailableReplicas:
                    description: UpdatedAvailableReplicas is the number of updated available replicas
                    format: int32
                    type: integer
                  updatedReadyReplicas:
                    description: UpdatedReadyReplicas is the number of updated ready replicas
                    format: int32
                    type: integer
                  updatedReplicas:
                    description: UpdatedReplicas is the number of updated replicas
                    format: int32
                    type: integer
                required:
                - observedGenerationUpdated
                - replicas
                - updatedAvailableReplicas
                - updatedReadyReplicas
                - updatedReplicas
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
